# 🚀 AIcoin 快速开始指南

> **5分钟快速上手** | 从零到运行 | v4.1

---

## 📋 系统概述

AIcoin 是一个**企业级 AI 驱动的加密货币智能交易系统**，具备以下核心特性:

- 🤖 **双 AI 引擎**: DeepSeek 决策 + Qwen 情报
- 🛡️ **完整风控**: L0-L5 动态权限 + 8 项硬约束
- 💰 **成本管理**: AI 使用追踪 + 预算控制
- 🔐 **RBAC 权限**: 企业级角色权限管理
- ⚔️ **辩论系统**: 多空对抗决策机制
- 📊 **实时监控**: 交易监控 + 性能分析

### 系统架构

```
┌─────────────────────────────────────────────────────┐
│                  AIcoin 系统架构                      │
├─────────────────────────────────────────────────────┤
│                                                     │
│  前端 (Next.js 14)                                   │
│         ↓                                           │
│  API 网关 (FastAPI)                                  │
│         ↓                                           │
│  ┌──────────┬──────────┬──────────┐                │
│  │ AI 决策   │ 情报系统  │ 交易执行  │                │
│  │ DeepSeek │ Qwen     │ Hyperliq │                │
│  └──────────┴──────────┴──────────┘                │
│         ↓                                           │
│  数据层: PostgreSQL + Redis + Qdrant                 │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

## 🚀 快速启动

### 方式一: Docker 一键启动 (推荐)

**适用场景**: 快速体验、生产部署

```bash
# 1. 克隆项目
git clone https://github.com/allenxing4071/aicoin.git
cd aicoin

# 2. 配置环境变量
cp .env.example .env
nano .env  # 填入必需的 API 密钥

# 3. 一键启动
docker-compose up -d

# 4. 访问系统
# 前端: http://localhost:3000
# 后端: http://localhost:8000
# API 文档: http://localhost:8000/docs
```

---

### 方式二: 测试网环境

**适用场景**: 新手学习、策略测试

```bash
# 1. 配置测试网
cp .env.testnet.example .env.testnet
nano .env.testnet  # 填入测试网配置

# 2. 启动测试网
./scripts/start_testnet.sh

# 3. 监控系统
./scripts/monitor/monitor_system.sh
```

**测试网优势**:
- ✅ 测试币无价值,可以放心测试
- ✅ 连接真实的 Hyperliquid 测试网
- ✅ 验证 AI 决策逻辑

---

### 方式三: 本地开发环境

**适用场景**: 开发调试、功能定制

```bash
# 1. 启动数据库
docker-compose up -d postgres redis qdrant

# 2. 后端开发
cd backend
pip install -r requirements.txt
python -m uvicorn app.main:app --reload --port 8000

# 3. 前端开发
cd frontend
npm install
npm run dev

# 4. 访问
# 前端: http://localhost:3000
# 后端: http://localhost:8000
```

---

## 🔧 核心配置

### 必需配置

```bash
# .env 文件

# ========== AI 平台 (必需) ==========
DEEPSEEK_API_KEY=sk-your-deepseek-key    # 交易决策
QWEN_API_KEY=sk-your-qwen-key            # 情报分析 (可选)

# ========== 交易所 (必需) ==========
HYPERLIQUID_PRIVATE_KEY=0xxxx            # 私钥
HYPERLIQUID_WALLET_ADDRESS=0xxxx         # 钱包地址
HYPERLIQUID_TESTNET=true                 # true=测试网, false=主网

# ========== 数据库 (自动配置) ==========
DATABASE_URL=postgresql://aicoin:password@postgres:5432/aicoin
REDIS_URL=redis://redis:6379
QDRANT_URL=http://qdrant:6333

# ========== 安全 (必需) ==========
SECRET_KEY=your-secret-key-change-this   # 应用密钥
JWT_SECRET_KEY=your-jwt-secret-key       # JWT 密钥
```

### 交易配置

```bash
# ========== 交易开关 ==========
TRADING_ENABLED=true                     # true=启用 AI 交易

# ========== 决策频率 ==========
DECISION_INTERVAL=600                    # 600 秒 = 10 分钟

# ========== 初始权限 ==========
INITIAL_PERMISSION_LEVEL=L1              # L1=新手级 (最保守)

# ========== 风控参数 ==========
MAX_POSITION_PCT=0.20                    # 最大仓位 20%
MAX_DAILY_LOSS_PCT=0.05                  # 单日最大亏损 5%
MAX_DRAWDOWN_PCT=0.10                    # 最大回撤 10%
MIN_CONFIDENCE=0.80                      # 最低置信度 80%
```

---

## 📊 权限等级系统 (L0-L5)

| 等级 | 名称 | 单仓位 | 杠杆 | 置信度 | 日频率 | 适用场景 |
|------|------|--------|------|--------|--------|---------|
| L0 | 保护模式 | 0% | 1x | 100% | 0 | 风控触发 |
| **L1** | **新手级** | **10%** | **2x** | **80%** | **1次** | **建议起步** |
| L2 | 成长级 | 12% | 2x | 75% | 2次 | 稳定后升级 |
| L3 | 稳定级 | 15% | 3x | 70% | 4次 | 长期稳定 |
| L4 | 熟练级 | 20% | 4x | 65% | 6次 | 高级用户 |
| L5 | 专家级 | 25% | 5x | 60% | 无限 | 专家模式 |

**建议**: 从 L1 开始,让系统根据表现自动升级

---

## 🛡️ 风控系统 (8 项红线)

```
1. 保证金率 ≥ 20%         # 低于 20% 拒绝交易
2. 总回撤 < 15%            # 超过 15% 强制平仓
3. 单日亏损 < 5%           # 超过 5% 停止交易
4. 杠杆 ≤ 2x               # 最大 2 倍杠杆
5. 现金储备 ≥ 10%         # 至少保留 10% 现金
6. 单资产敞口 ≤ 10%       # 单币种不超 10%
7. 单笔亏损 < 5%           # 单笔不超 5%
8. 强制平仓阈值 = 15%     # 15% 回撤强制平仓
```

**这些是不可违反的硬约束,任何决策违反都会被拒绝**

---

## 💡 核心运行机制

### 三大循环

```
1. 决策循环 (10 分钟/次)
   ├─ 获取市场数据
   ├─ 获取账户状态
   ├─ AI 决策 (DeepSeek)
   ├─ 风控验证
   └─ 执行交易

2. 监控循环 (实时)
   ├─ 检查账户状态
   ├─ 风控检查
   ├─ 权限评估
   └─ 发送告警

3. 情报循环 (30 分钟/次)
   ├─ Qwen 收集情报
   ├─ 分析市场情绪
   └─ 存储情报报告
```

### 决策流程

```
市场数据 + 账户状态
    ↓
权限检查 (L0-L5)
    ↓
记忆检索 (Qdrant)
    ↓
情报获取 (Qwen,可选)
    ↓
辩论系统 (多空对抗)
    ↓
AI 决策 (DeepSeek)
    ↓
软约束验证 (置信度、频率)
    ↓
硬约束验证 (8 项红线)
    ↓
权限验证
    ↓
执行交易 / 拒绝
```

---

## 📱 访问地址

### 本地开发

```
前端界面:     http://localhost:3000
后端 API:     http://localhost:8000
API 文档:     http://localhost:8000/docs
Qdrant 控制台: http://localhost:6333/dashboard
```

### 主要页面

```
首页:        /                    # 交易监控
管理后台:    /admin               # 管理中心
AI 平台:     /admin/ai-platforms  # AI 平台管理
成本管理:    /admin/ai-cost       # AI 成本管理
情报系统:    /admin/intelligence  # 情报分析
辩论系统:    /admin/debate        # 多空辩论
权限管理:    /admin/rbac          # RBAC 权限
数据库:      /admin/database      # 数据库管理
```

---

## 📦 常用命令

### Docker 服务管理

```bash
# 启动所有服务
docker-compose up -d

# 停止所有服务
docker-compose down

# 重启后端
docker-compose restart backend

# 重启前端
docker-compose restart frontend

# 查看服务状态
docker-compose ps

# 查看资源使用
docker stats
```

### 日志查看

```bash
# 查看所有日志
docker-compose logs -f

# 只看后端日志
docker-compose logs -f backend

# 只看错误日志
docker-compose logs backend | grep ERROR

# 只看 AI 决策日志
docker-compose logs backend | grep "决策"

# 只看关键信息 (带 emoji)
docker-compose logs backend | grep -E "(🔄|✅|❌|⚠️|🤖)"
```

### 健康检查

```bash
# 后端健康检查
curl http://localhost:8000/health | jq .

# 系统状态
curl http://localhost:8000/api/v1/status | jq .

# 账户信息
curl http://localhost:8000/api/v1/account/info | jq .

# 最近决策
curl http://localhost:8000/api/v1/ai/decisions?limit=5 | jq .
```

### 系统监控

```bash
# 实时监控 (推荐)
./scripts/monitor/monitor_system.sh

# 后台告警监控
./scripts/alert_config.sh daemon &

# 查看告警日志
tail -f logs/alerts.log
```

---

## ⚠️ 常见问题

### 1. 容器启动失败

```bash
# 检查端口占用
lsof -i :8000
lsof -i :3000
lsof -i :5432

# 清理并重启
docker-compose down
docker-compose up -d --build
```

### 2. 数据库连接失败

```bash
# 检查 PostgreSQL 健康状态
docker-compose exec postgres pg_isready -U aicoin

# 重启数据库
docker-compose restart postgres

# 查看数据库日志
docker-compose logs postgres
```

### 3. AI 决策一直被拒绝

**原因**: 可能是置信度不足或触发风控

```bash
# 查看决策日志
docker-compose logs backend | grep "决策"

# 查看拒绝原因
docker-compose logs backend | grep "拒绝"

# 检查权限等级
curl http://localhost:8000/api/v1/ai/permission | jq .
```

**解决方案**:
- 正常现象,说明风控在工作
- L1 要求 80% 置信度,非常保守
- 等待高置信度机会 (推荐)
- 或降低置信度阈值 (不推荐)

### 4. 前端无法连接后端

```bash
# 检查后端是否运行
curl http://localhost:8000/health

# 检查 CORS 配置
# 编辑 backend/app/core/config.py
# 确保 CORS_ORIGINS 包含前端地址

# 重启后端
docker-compose restart backend
```

### 5. 端口冲突

```bash
# 检查端口占用
lsof -i :8000
lsof -i :3000

# 修改端口映射
nano docker-compose.yml
# 修改 ports 配置,如 "8001:8000"

# 重启服务
docker-compose down
docker-compose up -d
```

---

## 🎯 使用建议

### 新手建议

1. **从测试网开始**
   - 先在测试网运行至少 7 天
   - 观察 AI 决策是否合理
   - 验证风控系统是否正常

2. **小资金试运行**
   - 主网建议从 $100-$200 起步
   - 使用 L1 权限等级
   - 密切监控前 24 小时

3. **理解核心概念**
   - 阅读核心规则文档
   - 理解 L0-L5 权限系统
   - 掌握风控参数

### 进阶使用

1. **调整决策频率**
   ```bash
   # 编辑 .env
   DECISION_INTERVAL=300   # 改为 5 分钟 (更激进)
   DECISION_INTERVAL=1800  # 改为 30 分钟 (更保守)
   ```

2. **调整风控参数**
   ```bash
   # 编辑 .env
   MAX_POSITION_PCT=0.15      # 降低最大仓位
   MAX_DAILY_LOSS_PCT=0.03    # 降低单日亏损限制
   MIN_CONFIDENCE=0.70        # 提高置信度要求
   ```

3. **启用更多 AI 平台**
   ```bash
   # 编辑 .env
   DOUBAO_API_KEY=sk-xxx      # 启用豆包分析
   CLAUDE_API_KEY=sk-xxx      # 启用 Claude 分析
   ```

4. **启用辩论系统**
   ```bash
   # 编辑 .env
   DEBATE_ENABLED=true        # 启用多空辩论
   DEBATE_ROUNDS=3            # 辩论轮数
   ```

---

## ✅ 快速检查清单

使用前请确认:

- [ ] Docker 和 Docker Compose 已安装
- [ ] 环境变量已正确配置 (.env 文件)
- [ ] API 密钥已填入 (DEEPSEEK_API_KEY 等)
- [ ] 容器全部运行中 (`docker-compose ps`)
- [ ] 后端健康检查通过 (`curl http://localhost:8000/health`)
- [ ] 前端可以访问 (http://localhost:3000)
- [ ] 理解权限等级系统 (L0-L5)
- [ ] 理解风控参数 (8 项红线)
- [ ] 知道如何查看日志
- [ ] 知道如何紧急停止

---

## 🆘 紧急情况处理

### 如果系统失控

```bash
# 1. 立即停止所有服务
docker-compose down

# 或使用紧急停止脚本
./scripts/stop_system_emergency.sh

# 2. 手动登录交易所平仓
# Hyperliquid: https://app.hyperliquid.xyz/

# 3. 查看日志找原因
docker-compose logs backend > emergency_log.txt

# 4. 保存配置快照
cp .env emergency_config.backup
```

---

## 📚 进一步学习

### 核心文档

1. **技术架构**
   - [系统架构设计](../03-技术架构/00-系统架构设计.md)
   - [Qwen 情报系统](../03-技术架构/06-Qwen情报系统.md)
   - [RBAC 权限系统](../03-技术架构/08-RBAC权限系统.md)
   - [辩论系统](../03-技术架构/09-辩论系统.md)

2. **部署运维**
   - [部署指南](../07-部署运维/01-部署指南.md)
   - [Git 自动化部署](../07-部署运维/10-Git自动化部署指南.md)
   - [日志管理系统](../07-部署运维/09-日志管理系统.md)

3. **快速参考**
   - [核心要点速查卡](../06-快速参考/01-核心要点速查卡.md)
   - [权限管理速查](../06-快速参考/02-权限管理速查.md)
   - [术语表](../06-快速参考/03-术语表.md)

4. **研究报告**
   - [项目深度分析报告](../04-研究报告/05-AIcoin项目深度分析报告.md)
   - [AI 交易策略研究](../04-研究报告/02-AI交易策略研究.md)

### API 文档

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **API 文档**: [docs/09-API接口文档/README.md](../09-API接口文档/README.md)

---

## 🆘 获取帮助

### 问题排查

1. **查看日志**: `docker-compose logs -f backend`
2. **健康检查**: `curl http://localhost:8000/health`
3. **查看文档**: `docs/` 目录下有完整文档
4. **提交 Issue**: [GitHub Issues](https://github.com/allenxing4071/aicoin/issues)

### 联系方式

- **GitHub**: https://github.com/allenxing4071/aicoin
- **Issues**: https://github.com/allenxing4071/aicoin/issues
- **Discussions**: https://github.com/allenxing4071/aicoin/discussions

---

**文档版本**: v2.0  
**最后更新**: 2025-11-15  
**适用版本**: AIcoin v4.1

**祝交易顺利！** 🚀

