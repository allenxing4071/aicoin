# 版本管理自动化配置完成

## 📋 问题

API 文档页面显示的版本号是 v3.1，但实际已完成 v3.2 的开发工作。

## ✅ 解决方案

### 1. 创建版本号单一真实来源

创建 `VERSION` 文件作为版本号的单一真实来源：
```
3.2.0
```

### 2. 更新后端配置

修改 `backend/app/core/config.py`:
```python
APP_VERSION: str = "3.2.0"
```

### 3. 创建自动更新脚本

创建 `scripts/utils/update_version.sh`，实现一键更新所有位置的版本号：

**功能**:
- ✅ 验证版本号格式
- ✅ 更新 VERSION 文件
- ✅ 更新后端配置
- ✅ 更新前端配置
- ✅ 更新 README
- ✅ 创建 Git 标签（可选）
- ✅ 推送到远程（可选）

**用法**:
```bash
./scripts/utils/update_version.sh 3.3.0
```

### 4. 创建版本管理文档

创建 `docs/07-部署运维/07-版本管理指南.md`，包含：
- 版本号规范（语义化版本）
- 版本号存储位置
- 自动更新流程
- 手动更新方法
- 版本发布流程
- 问题排查

## 🎯 效果

### 更新前
- 版本号分散在多个文件
- 手动更新容易遗漏
- 没有统一的更新流程

### 更新后
- ✅ 版本号集中管理
- ✅ 一键自动更新所有位置
- ✅ 完整的文档和流程
- ✅ API 文档显示正确版本号

## 📚 相关文件

### 新增文件
1. `VERSION` - 版本号文件
2. `scripts/utils/update_version.sh` - 自动更新脚本
3. `docs/07-部署运维/07-版本管理指南.md` - 版本管理文档
4. `VERSION_UPDATE_v3.2.0.md` - 本次更新说明（已归档）

### 修改文件
1. `backend/app/core/config.py` - 版本号 3.1.0 → 3.2.0

## 🔄 未来更新流程

### 快速更新（推荐）
```bash
# 1. 更新版本号
./scripts/utils/update_version.sh 3.3.0

# 2. 重新构建
docker compose build

# 3. 重启服务
docker compose up -d
```

### 完整发布流程
```bash
# 1. 更新版本号
./scripts/utils/update_version.sh 3.3.0

# 2. 更新 CHANGELOG
vim CHANGELOG.md

# 3. 提交变更
git add .
git commit -m "chore: bump version to 3.3.0"
git push

# 4. 创建标签
git tag -a v3.3.0 -m "Release version 3.3.0"
git push origin v3.3.0

# 5. 重新构建部署
docker compose build
docker compose up -d
```

## 🎊 总结

通过创建自动化脚本和完整文档，实现了：

1. **版本号统一管理** - VERSION 文件作为单一真实来源
2. **自动化更新** - 一条命令更新所有位置
3. **流程标准化** - 清晰的发布流程和规范
4. **文档完善** - 详细的使用指南和问题排查

未来更新版本只需一条命令，大大提高了效率和准确性！

---

*完成时间: 2025-11-10*  
*当前版本: v3.2.0*
