# æƒé™ç­‰çº§ç®¡ç† - å¿«é€Ÿå‚è€ƒ

> å¿«é€Ÿä¸Šæ‰‹æŒ‡å—ï¼Œé€‚åˆäº§å“ç»ç†å’Œè¿ç»´äººå‘˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1åˆ†é’Ÿåˆå§‹åŒ–

```bash
# 1. è¿è¡Œæ•°æ®åº“è¿ç§»
cd backend && alembic upgrade head

# 2. åˆå§‹åŒ–é»˜è®¤é…ç½®
curl -X POST http://localhost:8000/api/v1/admin/permissions/levels/init-defaults

# 3. è®¿é—®ç®¡ç†ç•Œé¢
open http://localhost:3000/admin/permissions
```

---

## ğŸ“Š æƒé™ç­‰çº§é€ŸæŸ¥è¡¨

| ç­‰çº§ | ä»“ä½ | æ æ† | ç½®ä¿¡åº¦ | æ—¥äº¤æ˜“ | é€‚ç”¨åœºæ™¯ |
|:----:|:----:|:----:|:------:|:------:|----------|
| **L0** | 0% | 1x | 100% | 0 | ğŸ›¡ï¸ ä¿æŠ¤æ¨¡å¼ï¼ˆç¦æ­¢äº¤æ˜“ï¼‰ |
| **L1** | 10% | 2x | 50% | 10 | ğŸŒ± æ–°æ‰‹ï¼ˆ$50ä»¥ä¸‹ï¼Œæ¿€è¿›ï¼‰ |
| **L2** | 12% | 2x | 75% | 2 | ğŸ“ˆ æˆé•¿ï¼ˆè¡¨ç°è‰¯å¥½ï¼‰ |
| **L3** | 15% | 3x | 70% | 4 | âš–ï¸ ç¨³å®šï¼ˆ$200-$1000ï¼‰ |
| **L4** | 20% | 4x | 65% | 6 | ğŸ¯ ç†Ÿç»ƒï¼ˆ$1000+ï¼‰ |
| **L5** | 25% | 5x | 60% | 999 | ğŸ† ä¸“å®¶ï¼ˆé•¿æœŸä¼˜ç§€ï¼‰ |

---

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### è°ƒæ•´L1å‚æ•°ï¼ˆæœ€å¸¸ç”¨ï¼‰

**åœºæ™¯1: AIå¤ªä¿å®ˆï¼Œå¾ˆå°‘äº¤æ˜“**
```bash
curl -X PUT http://localhost:8000/api/v1/admin/permissions/levels/L1 \
  -H "Content-Type: application/json" \
  -d '{
    "trading_params": {
      "confidence_threshold": 0.45,
      "max_daily_trades": 15
    }
  }'
```

**åœºæ™¯2: AIäºæŸå¤ªå¤šï¼Œéœ€è¦æ›´ä¸¥æ ¼**
```bash
curl -X PUT http://localhost:8000/api/v1/admin/permissions/levels/L1 \
  -H "Content-Type: application/json" \
  -d '{
    "trading_params": {
      "confidence_threshold": 0.70,
      "max_daily_trades": 5,
      "max_position_pct": 0.05
    }
  }'
```

---

## ğŸ“± å‰ç«¯æ“ä½œæŒ‡å—

### è®¿é—®åœ°å€
```
http://localhost:3000/admin/permissions
```

### æ“ä½œæ­¥éª¤

1. **ç¼–è¾‘å‚æ•°**
   - ç‚¹å‡»ç­‰çº§å¡ç‰‡çš„"ç¼–è¾‘"æŒ‰é’®
   - ä¿®æ”¹æ•°å€¼
   - ä¿å­˜

2. **è®¾ç½®é»˜è®¤ç­‰çº§**
   - ç‚¹å‡»"è®¾ä¸ºé»˜è®¤"æŒ‰é’®
   - æ–°AIå°†ä½¿ç”¨æ­¤ç­‰çº§å¯åŠ¨

3. **æ¢å¤é»˜è®¤é…ç½®**
   - ç‚¹å‡»å³ä¸Šè§’"åˆå§‹åŒ–é»˜è®¤é…ç½®"
   - ç¡®è®¤æ“ä½œ

---

## ğŸ¯ ä¸åŒèµ„é‡‘è§„æ¨¡çš„æ¨èé…ç½®

### å°èµ„é‡‘ ($50-$200)
```json
{
  "L1": {
    "max_position_pct": 0.10,
    "confidence_threshold": 0.50,
    "max_daily_trades": 10
  }
}
```
**ç‰¹ç‚¹**: æ¿€è¿›ç­–ç•¥ï¼Œå¿«é€Ÿç§¯ç´¯ç»éªŒ

---

### ä¸­ç­‰èµ„é‡‘ ($200-$1000)
```json
{
  "L1": {
    "max_position_pct": 0.08,
    "confidence_threshold": 0.65,
    "max_daily_trades": 5
  }
}
```
**ç‰¹ç‚¹**: å¹³è¡¡ç­–ç•¥ï¼Œæ³¨é‡è´¨é‡

---

### å¤§èµ„é‡‘ ($1000+)
```json
{
  "L1": {
    "max_position_pct": 0.05,
    "confidence_threshold": 0.75,
    "max_daily_trades": 3
  }
}
```
**ç‰¹ç‚¹**: ä¿å®ˆç­–ç•¥ï¼Œç²¾é€‰äº¤æ˜“

---

## ğŸ” ç›‘æ§å‘½ä»¤

### æŸ¥çœ‹å½“å‰é…ç½®
```bash
curl http://localhost:8000/api/v1/admin/permissions/levels
```

### æŸ¥çœ‹æƒé™å˜åŒ–æ—¥å¿—
```bash
docker logs aicoin-backend-prod-v2 | grep "æƒé™"
```

### æŸ¥çœ‹AIå†³ç­–ç»Ÿè®¡
```bash
docker logs aicoin-backend-prod-v2 | grep "å†³ç­–" | tail -20
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q: ä¿®æ”¹åå¤šä¹…ç”Ÿæ•ˆï¼Ÿ
**A**: æœ€é•¿5åˆ†é’Ÿï¼ˆç¼“å­˜åˆ·æ–°ï¼‰

### Q: æ•°æ®åº“æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ
**A**: è‡ªåŠ¨ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œä¸å½±å“è¿è¡Œ

### Q: å¦‚ä½•ç«‹å³ç”Ÿæ•ˆï¼Ÿ
**A**: é‡å¯backendå®¹å™¨
```bash
docker-compose restart backend
```

---

## ğŸ“ ç´§æ€¥æ“ä½œ

### å¼ºåˆ¶é™çº§åˆ°L0ï¼ˆç´§æ€¥æ­¢æŸï¼‰
```bash
# æ‰‹åŠ¨ä¿®æ”¹æ•°æ®åº“
psql -U admin -d aicoin -c \
  "UPDATE ai_instances SET permission_level = 'L0' WHERE id = 1;"

# é‡å¯å®¹å™¨
docker-compose restart backend
```

### æ¢å¤é»˜è®¤é…ç½®
```bash
curl -X POST http://localhost:8000/api/v1/admin/permissions/levels/init-defaults
```

---

## ğŸ“ æœ€ä½³å®è·µ

1. âœ… **å®šæœŸæ£€æŸ¥**: æ¯å‘¨æ£€æŸ¥æƒé™ç­‰çº§åˆ†å¸ƒ
2. âœ… **å°æ­¥è¿­ä»£**: æ¯æ¬¡åªè°ƒæ•´ä¸€ä¸ªå‚æ•°
3. âœ… **è®°å½•å˜æ›´**: åœ¨æ–‡æ¡£ä¸­è®°å½•æ¯æ¬¡ä¿®æ”¹
4. âœ… **è§‚å¯Ÿæ•ˆæœ**: ä¿®æ”¹åè§‚å¯Ÿè‡³å°‘24å°æ—¶
5. âœ… **å¤‡ä»½é…ç½®**: é‡å¤§ä¿®æ”¹å‰å¤‡ä»½å½“å‰é…ç½®

---

## ğŸ“‹ å¿«é€Ÿè¯Šæ–­æ£€æŸ¥å•

- [ ] AIæ˜¯å¦åœ¨è¿è¡Œï¼Ÿ `docker ps | grep backend`
- [ ] æ•°æ®åº“æ˜¯å¦æ­£å¸¸ï¼Ÿ `psql -U admin -d aicoin -c "SELECT 1;"`
- [ ] é…ç½®æ˜¯å¦å·²åˆå§‹åŒ–ï¼Ÿ `SELECT COUNT(*) FROM permission_level_configs;`
- [ ] å½“å‰æ˜¯ä»€ä¹ˆç­‰çº§ï¼Ÿ `SELECT permission_level FROM ai_instances LIMIT 1;`
- [ ] æœ€è¿‘æœ‰äº¤æ˜“å—ï¼Ÿ `docker logs backend | grep "å†³ç­–" | tail -5`

---

## ğŸ”— ç›¸å…³é“¾æ¥

- ğŸ“– [å®Œæ•´æ–‡æ¡£](./æƒé™ç­‰çº§ç®¡ç†ç³»ç»Ÿ.md)
- ğŸŒ [APIæ–‡æ¡£](http://localhost:8000/docs)
- ğŸ’» [ç®¡ç†ç•Œé¢](http://localhost:3000/admin/permissions)
- ğŸ“Š [ç›‘æ§é¢æ¿](http://localhost:3000/admin)

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹å®Œæ•´æ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯å›¢é˜Ÿ

