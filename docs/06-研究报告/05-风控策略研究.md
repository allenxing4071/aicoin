# é£æ§ç­–ç•¥ç ”ç©¶

**æ–‡æ¡£ç¼–å·**: AICOIN-RESEARCH-005  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-22

---

## 1. ä¸‰å±‚é£æ§ä½“ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸€å±‚: é¢„æ‰§è¡Œé£æ§                 â”‚
â”‚  - ä»“ä½é™åˆ¶                        â”‚
â”‚  - æ­¢æŸæ£€æŸ¥                        â”‚
â”‚  - å•æ—¥äºæŸé™åˆ¶                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬äºŒå±‚: æ‰§è¡Œç›‘æ§                  â”‚
â”‚  - APIé™é€Ÿ                         â”‚
â”‚  - æ»‘ç‚¹æ§åˆ¶                        â”‚
â”‚  - æˆäº¤ç¡®è®¤                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸‰å±‚: åº”æ€¥ç†”æ–­                  â”‚
â”‚  - æç«¯è¡Œæƒ…è‡ªåŠ¨å¹³ä»“                â”‚
â”‚  - è¿ç»­äºæŸæš‚åœ                    â”‚
â”‚  - äººå·¥å¹²é¢„æœºåˆ¶                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ ¸å¿ƒé£æ§è§„åˆ™

### 2.1 ä»“ä½é™åˆ¶ (RC-001)

```python
class PositionLimit:
    MAX_SINGLE_POSITION = 0.20  # å•ç¬”æœ€å¤§20%
    
    def check(self, order_size, total_balance):
        if order_size > total_balance * self.MAX_SINGLE_POSITION:
            return False, f"è¶…è¿‡ä»“ä½é™åˆ¶{self.MAX_SINGLE_POSITION*100}%"
        return True, "OK"

# ç¤ºä¾‹
æ€»èµ„é‡‘: $10,000
å•ç¬”é™åˆ¶: $2,000
å®é™…è®¢å•: $1,500 âœ“
å®é™…è®¢å•: $2,500 âœ—
```

### 2.2 å•æ—¥äºæŸé™åˆ¶ (RC-002)

```python
class DailyLossLimit:
    MAX_DAILY_LOSS = 0.05  # å•æ—¥æœ€å¤§äºæŸ5%
    
    def check(self, today_pnl, total_balance):
        loss_pct = -today_pnl / total_balance
        
        if loss_pct > self.MAX_DAILY_LOSS:
            return False, f"è¾¾åˆ°å•æ—¥äºæŸé™åˆ¶{self.MAX_DAILY_LOSS*100}%"
        return True, "OK"

# ç¤ºä¾‹
æ€»èµ„é‡‘: $10,000
ä»Šæ—¥äºæŸ: -$400 (4%) âœ“
ä»Šæ—¥äºæŸ: -$600 (6%) âœ— â†’ åœæ­¢äº¤æ˜“
```

### 2.3 æœ€å¤§å›æ’¤é™åˆ¶ (RC-003)

```python
class MaxDrawdownLimit:
    MAX_DRAWDOWN = 0.10  # æœ€å¤§å›æ’¤10%
    
    def check(self, current_equity, peak_equity):
        drawdown = (peak_equity - current_equity) / peak_equity
        
        if drawdown > self.MAX_DRAWDOWN:
            return False, "è§¦å‘æœ€å¤§å›æ’¤ç†”æ–­,å…¨éƒ¨å¹³ä»“"
        return True, "OK"

# ç¤ºä¾‹
å†å²æœ€é«˜å‡€å€¼: $11,000
å½“å‰å‡€å€¼: $10,000
å›æ’¤: 9.09% âœ“
å½“å‰å‡€å€¼: $9,800
å›æ’¤: 10.9% âœ— â†’ å¼ºåˆ¶å¹³ä»“
```

### 2.4 è¿ç»­äºæŸé™åˆ¶ (RC-004)

```python
class ConsecutiveLossLimit:
    MAX_CONSECUTIVE_LOSS = 3
    
    def check(self, recent_trades):
        consecutive_losses = 0
        
        for trade in reversed(recent_trades):
            if trade.pnl < 0:
                consecutive_losses += 1
            else:
                break
        
        if consecutive_losses >= self.MAX_CONSECUTIVE_LOSS:
            return False, "è¿ç»­äºæŸ3ç¬”,æš‚åœäº¤æ˜“,äººå·¥å®¡æ ¸"
        return True, "OK"
```

---

## 3. æ­¢æŸç­–ç•¥

### 3.1 å›ºå®šæ­¢æŸ

```python
STOP_LOSS_PCT = 0.03  # 3%å›ºå®šæ­¢æŸ

def check_stop_loss(position):
    if position.unrealized_pnl_pct < -STOP_LOSS_PCT:
        close_position(position)
        log("è§¦å‘æ­¢æŸ: {position.symbol} @ {position.unrealized_pnl_pct}%")
```

### 3.2 è¿½è¸ªæ­¢æŸ (Trailing Stop)

```python
def trailing_stop(position, peak_price):
    """ä»æœ€é«˜ç‚¹å›æ’¤3%æ­¢æŸ"""
    current_price = get_current_price(position.symbol)
    drawdown = (peak_price - current_price) / peak_price
    
    if drawdown > 0.03:
        close_position(position)
        log(f"è§¦å‘è¿½è¸ªæ­¢æŸ: ä»${peak_price}å›æ’¤è‡³${current_price}")
```

---

## 4. æç«¯è¡Œæƒ…åº”å¯¹

### 4.1 ç†”æ–­æœºåˆ¶

```python
def circuit_breaker():
    """æç«¯è¡Œæƒ…ç†”æ–­"""
    
    # æ¡ä»¶1: å•æ—¥äºæŸ>5%
    if today_loss_pct > 0.05:
        close_all_positions()
        pause_trading(24)  # æš‚åœ24å°æ—¶
        alert("ç†”æ–­è§¦å‘: å•æ—¥äºæŸ{today_loss_pct}%")
    
    # æ¡ä»¶2: æ€»å›æ’¤>10%
    if max_drawdown > 0.10:
        close_all_positions()
        pause_trading(72)  # æš‚åœ72å°æ—¶
        alert("ç†”æ–­è§¦å‘: æœ€å¤§å›æ’¤{max_drawdown}%")
    
    # æ¡ä»¶3: å¸‚åœºæ³¢åŠ¨>20%
    if market_volatility > 0.20:
        reduce_positions(0.5)  # å‡ä»“50%
        alert("é«˜æ³¢åŠ¨é¢„è­¦: {market_volatility}%")
```

---

## 5. ç›‘æ§ä¸å‘Šè­¦

### 5.1 å®æ—¶ç›‘æ§

```python
@celery_app.task(schedule=60)  # æ¯åˆ†é’Ÿæ£€æŸ¥
def risk_monitoring():
    account = get_account_info()
    
    # æ£€æŸ¥å„é¡¹é£æ§æŒ‡æ ‡
    checks = [
        check_position_limit(),
        check_daily_loss(),
        check_max_drawdown(),
        check_consecutive_loss(),
    ]
    
    # è®°å½•é£é™©äº‹ä»¶
    for check_name, passed, reason in checks:
        if not passed:
            log_risk_event(
                event_type=check_name,
                severity="HIGH",
                description=reason
            )
            send_alert(reason)
```

### 5.2 å‘Šè­¦çº§åˆ«

| çº§åˆ« | æ¡ä»¶ | å“åº” |
|------|------|------|
| ğŸŸ¢ æ­£å¸¸ | æ‰€æœ‰é£æ§æŒ‡æ ‡æ­£å¸¸ | æ­£å¸¸äº¤æ˜“ |
| ğŸŸ¡ è­¦å‘Š | å•æ—¥äºæŸ3-5% | å‡å°‘äº¤æ˜“é¢‘ç‡ |
| ğŸ”´ å±é™© | å•æ—¥äºæŸ>5% æˆ– å›æ’¤>10% | åœæ­¢äº¤æ˜“ |
| âš« ç´§æ€¥ | è¿ç»­äºæŸ5ç¬” æˆ– æœ¬é‡‘æŸå¤±>20% | äººå·¥ä»‹å…¥,ç­–ç•¥è¯„ä¼° |

---

## 6. é£æ§å‚æ•°é…ç½®

```python
# config/risk_config.py

RISK_CONFIG = {
    # ä»“ä½æ§åˆ¶
    "max_single_position": 0.20,  # 20%
    "max_total_position": 0.50,   # æ€»æŒä»“50%
    
    # æ­¢æŸ
    "stop_loss_pct": 0.03,        # 3%
    "trailing_stop_pct": 0.03,    # 3%
    
    # äºæŸé™åˆ¶
    "max_daily_loss": 0.05,       # 5%
    "max_drawdown": 0.10,         # 10%
    "max_consecutive_loss": 3,    # 3ç¬”
    
    # äº¤æ˜“é™åˆ¶
    "max_trades_per_day": 5,
    "min_interval_minutes": 30,   # æœ€å°äº¤æ˜“é—´éš”
    
    # ç†”æ–­
    "circuit_breaker_daily_loss": 0.05,
    "circuit_breaker_drawdown": 0.10,
}
```

---

## 7. é£æ§æ•ˆæœè¯„ä¼°

### 7.1 å›æµ‹éªŒè¯

```python
# æ— é£æ§ vs æœ‰é£æ§å¯¹æ¯”
ç»“æœ (æ¨¡æ‹Ÿæ•°æ®):

æ— é£æ§:
- æœ€å¤§å›æ’¤: -25%
- çˆ†ä»“æ¬¡æ•°: 1æ¬¡
- æœˆåŒ–æ”¶ç›Š: +15% (ä½†é£é™©æé«˜)

æœ‰é£æ§:
- æœ€å¤§å›æ’¤: -8%
- çˆ†ä»“æ¬¡æ•°: 0æ¬¡
- æœˆåŒ–æ”¶ç›Š: +10% (é£é™©å¯æ§)
- å¤æ™®æ¯”ç‡: 1.8 (ä¼˜ç§€)
```

---

**æ–‡æ¡£ç»“æŸ**

