# 📘 AIcoin 用户指南

> **完整使用手册** | 核心概念 | 权限系统 | 交易规则

---

## 📋 目录

1. [系统概述](#1-系统概述)
2. [核心概念](#2-核心概念)
3. [权限等级系统](#3-权限等级系统)
4. [交易规则](#4-交易规则)
5. [风险管理](#5-风险管理)
6. [常用术语](#6-常用术语)

---

## 1. 系统概述

### 1.1 AIcoin 是什么？

AIcoin 是一个**基于 AI 的自主加密货币交易系统**，使用 DeepSeek V3 大语言模型进行交易决策，通过动态权限管理和智能约束框架实现稳定盈利。

**核心特点**:
- 🤖 **AI 自主决策**: DeepSeek V3 驱动的智能交易
- 🛡️ **动态权限管理**: L0-L5 六级权限自动升降
- ⚖️ **智能风控**: 8 项硬约束 + 软约束指导
- 🧠 **记忆学习**: 三层记忆系统持续优化
- 📊 **多维监控**: 实时性能监控和告警

### 1.2 系统架构

```
用户 → 前端 Dashboard
         ↓
    FastAPI 后端
         ↓
    ┌────┴────┐
    │         │
AI 决策引擎  数据层
    │         │
DeepSeek   PostgreSQL
Qwen       Redis
           Qdrant
    │
    ↓
Hyperliquid 交易所
```

### 1.3 适用场景

| 用户类型 | 适用场景 | 推荐配置 |
|---------|---------|---------|
| **新手** | 学习 AI 交易 | 测试网 + L1 权限 |
| **进阶** | 小资金实盘 | 主网 + $100-500 |
| **专业** | 中等资金 | 主网 + $1000+ |
| **机构** | 大资金管理 | 定制化部署 |

---

## 2. 核心概念

### 2.1 AI 决策流程

```
1. 权限检查 (L0-L5)
   ↓
2. 获取市场数据
   ↓
3. 检索历史记忆
   ↓
4. 可选: 情报分析 (Qwen)
   ↓
5. 可选: 辩论系统 (多空对抗)
   ↓
6. AI 决策 (DeepSeek)
   ↓
7. 软约束验证 (置信度、频率)
   ↓
8. 硬约束验证 (8 项红线)
   ↓
9. 执行交易 / 拒绝
   ↓
10. 记录 + 评估 + 更新权限
```

### 2.2 三层记忆系统

#### 第一层: 短期记忆 (Redis)
- **存储**: 最近 100 个决策
- **保留**: 24 小时 - 7 天
- **用途**: 快速检索、频率控制

#### 第二层: 长期记忆 (Qdrant)
- **存储**: 历史决策向量化
- **保留**: 永久
- **用途**: 相似情况检索

#### 第三层: 知识库 (PostgreSQL)
- **存储**: 经验教训、策略评估
- **保留**: 永久
- **用途**: 结构化知识

### 2.3 可选功能

#### 情报系统 (Qwen)
- 收集新闻、社交媒体、链上数据
- 生成情报报告
- 辅助 AI 决策

#### 辩论系统
- Bull Analyst (多头分析师)
- Bear Analyst (空头分析师)
- Research Manager (研究经理)
- 多空对抗决策

---

## 3. 权限等级系统

### 3.1 L0-L5 权限表

| 等级 | 单仓位 | 杠杆 | 置信度 | 日频率 | 适用场景 |
|------|--------|------|--------|--------|---------|
| **L0** | 0% | 1x | 100% | 0 | 🛡️ **保护模式** (禁止交易) |
| **L1** | 10% | 2x | 80% | 1 | 🌱 **新手级** ($50以下) |
| **L2** | 12% | 2x | 75% | 2 | 📈 **成长级** (表现良好) |
| **L3** | 15% | 3x | 70% | 4 | ⚖️ **稳定级** ($200-$1000) |
| **L4** | 20% | 4x | 65% | 6 | 🎯 **熟练级** ($1000+) |
| **L5** | 25% | 5x | 60% | 无限 | 🏆 **专家级** (长期优秀) |

### 3.2 升级条件

#### L1 → L2
- 运行时间: ≥ 7 天
- 胜率: ≥ 50%
- 最大回撤: < 15%

#### L2 → L3
- 运行时间: ≥ 30 天
- 胜率: ≥ 50%
- 夏普比率: ≥ 1.0

#### L3 → L4
- 胜率: ≥ 60%
- 夏普比率: ≥ 1.5

#### L4 → L5
- 胜率: ≥ 70%
- 连续盈利天数: ≥ 20 天

### 3.3 降级触发

**自动降级**:
- 连续 3 次亏损 → 降 1 级
- 胜率低于等级要求 → 降 1 级

**强制降至 L0**:
- 总回撤 ≥ 15%
- 单日亏损 ≥ 5%
- 连续 5 次亏损
- 保证金率 < 15%

**L0 解除**:
- 需人工审核
- 确认问题已解决
- 手动升级到 L1

### 3.4 权限管理操作

#### 查看当前权限
```bash
curl http://localhost:8000/api/v1/permissions/current
```

#### 手动升级 (管理员)
```bash
curl -X POST http://localhost:8000/api/v1/admin/permissions/upgrade-to/L2
```

#### 手动降级 (管理员)
```bash
curl -X POST http://localhost:8000/api/v1/admin/permissions/downgrade-to/L1
```

#### 修改权限参数
```bash
curl -X PUT http://localhost:8000/api/v1/admin/permissions/levels/L1 \
  -H "Content-Type: application/json" \
  -d '{
    "trading_params": {
      "max_position_pct": 0.08,
      "confidence_threshold": 0.75
    }
  }'
```

---

## 4. 交易规则

### 4.1 核心原则

```
1. 资本保护优先
   保护本金 > 追求收益

2. 长期主义
   稳定收益 > 短期暴利

3. 风险收益平衡
   风险可控 > 高收益

4. 持续学习
   从历史中学习和优化
```

### 4.2 交易策略

#### 趋势跟随
- 识别市场趋势
- 顺势交易
- 设置止损止盈

#### 均值回归
- 识别超买超卖
- 逆势交易
- 快速止盈

#### 订单簿分析
- 分析买卖盘
- 识别支撑阻力
- 精准入场

### 4.3 止损止盈

**默认配置**:
- **止损**: 3% (单笔最大亏损)
- **止盈**: 5% (风险收益比 1:1.67)

**自动执行**:
- 达到止损 → 自动平仓
- 达到止盈 → 自动平仓

**动态调整**:
- 根据市场波动率调整
- 根据权限等级调整

### 4.4 仓位管理

**单仓位限制**:
```
L1: 10% (最保守)
L2: 12%
L3: 15%
L4: 20%
L5: 25% (最激进)
```

**总仓位限制**:
- 最大总仓位: 50%
- 现金储备: ≥ 10%

**杠杆限制**:
```
L1-L2: 2x
L3: 3x
L4: 4x
L5: 5x (硬约束上限)
```

---

## 5. 风险管理

### 5.1 八项硬约束 (红线)

```
1. 保证金率 ≥ 20%
   低于 20% 拒绝交易

2. 总回撤 < 15%
   超过 15% 强制平仓

3. 单日亏损 < 5%
   超过 5% 停止交易

4. 杠杆 ≤ 2x (默认)
   最大 5x (L5)

5. 现金储备 ≥ 10%
   至少保留 10% 现金

6. 单资产敞口 ≤ 10%
   单币种不超 10%

7. 单笔亏损 < 5%
   单笔不超 5%

8. 强制平仓阈值 = 15%
   15% 回撤强制平仓
```

### 5.2 软约束 (指导)

- **置信度门槛**: 根据权限等级 (60%-80%)
- **交易频率**: 根据权限等级 (1-无限次/天)
- **仓位大小**: 建议值，可灵活调整

### 5.3 风控触发后果

**触发硬约束**:
- 拒绝交易
- 触发告警
- 记录日志

**触发强制平仓**:
- 立即平掉所有仓位
- 降级到 L0
- 需人工审核

### 5.4 风险监控

**实时监控**:
```bash
# 查看风控状态
curl http://localhost:8000/api/v1/admin/risk/status

# 查看当前回撤
curl http://localhost:8000/api/v1/admin/risk/drawdown

# 查看保证金率
curl http://localhost:8000/api/v1/account/margin-ratio
```

---

## 6. 常用术语

### 6.1 权限相关

| 术语 | 解释 |
|------|------|
| **L0-L5** | 六级动态权限等级 |
| **置信度** | AI 决策的信心水平 (0-1) |
| **杠杆** | 放大投资资金的倍数 (1x-5x) |
| **仓位** | 投入交易的资金占比 |

### 6.2 交易相关

| 术语 | 解释 |
|------|------|
| **做多 (Long)** | 买入资产，期待价格上涨 |
| **做空 (Short)** | 卖出资产，期待价格下跌 |
| **止损 (Stop Loss)** | 预设的最大亏损点 |
| **止盈 (Take Profit)** | 预设的盈利目标 |

### 6.3 风险指标

| 术语 | 解释 |
|------|------|
| **胜率** | 盈利交易 / 总交易 |
| **夏普比率** | 风险调整后收益 (>1.0 良好) |
| **最大回撤** | 从峰值到谷底的最大跌幅 |
| **保证金率** | 净值 / 持仓价值 |

### 6.4 AI 相关

| 术语 | 解释 |
|------|------|
| **DeepSeek** | 主要 AI 决策模型 |
| **Qwen** | 情报分析模型 |
| **Prompt** | 给 AI 的指令文本 |
| **记忆系统** | 三层记忆架构 (Redis/Qdrant/PostgreSQL) |

### 6.5 技术术语

| 术语 | 解释 |
|------|------|
| **Docker** | 容器化技术 |
| **FastAPI** | Python Web 框架 |
| **PostgreSQL** | 主数据库 |
| **Redis** | 缓存数据库 |
| **Qdrant** | 向量数据库 |

---

## 📊 快速参考卡

### 新手必读
```
1. 从测试网开始
2. 初始权限 L1
3. 理解 8 项硬约束
4. 监控胜率和回撤
5. 耐心等待升级
```

### 日常检查
```
1. 查看当前权限等级
2. 查看今日交易记录
3. 查看账户余额
4. 查看风控状态
5. 查看系统日志
```

### 紧急操作
```
1. 停止交易: POST /api/v1/admin/trading/disable
2. 平掉所有仓位: POST /api/v1/admin/positions/close-all
3. 降级到 L0: POST /api/v1/admin/permissions/downgrade-to/L0
```

---

## 📚 相关文档

- [快速开始](../00-快速开始.md) - 5 分钟快速部署
- [技术架构](../03-开发文档/01-系统架构.md) - 系统架构说明
- [部署指南](../02-部署运维/01-快速部署.md) - 详细部署步骤
- [配置指南](../02-部署运维/02-配置指南.md) - 配置说明
- [故障排查](../02-部署运维/04-故障排查.md) - 问题诊断

---

## 🆘 获取帮助

- **文档中心**: [docs/README.md](../README.md)
- **GitHub Issues**: https://github.com/allenxing4071/aicoin/issues
- **API 文档**: http://localhost:8000/docs

---

**文档维护**: AIcoin Team  
**最后更新**: 2025-11-15  
**文档版本**: v2.0

